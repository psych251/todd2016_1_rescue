quarto publish quarto-pub
library(tidyverse)
#install.packages("rstatix")
library(rstatix)
library(ggplot2)
#install.packages("ggpubr")
library(ggpubr)
library(lme4)
#install.packages("ez")
library(ez)
#### Import data
dir_path <- "C:/Users/mateu/todd2016_1_rescue/data"
csv_files <- list.files(dir_path, pattern = "^results_.*\\.csv$", full.names = TRUE)
combined_data <- data.frame()
for (file in csv_files) {
data <- read_csv(file)
combined_data <- bind_rows(combined_data, data)
}
#### Data exclusion / filtering
processed_dat <- combined_data %>%
# filtering responses that were too slow
filter(!(is.na(key_resp.keys ))) %>%
#selecting relevant coluns
select(participant, session, face, object,
key_resp.keys, key_resp.rt, trials.thisTrialN, trials.thisIndex) %>%
# add race/ethnicity checks later!
#### Prepare data for analysis - create columns etc.
mutate(ID = participant,
StimRace = ifelse(grepl("w", face), "White", "Black"),
StimObj = ifelse(grepl("g", object), "Gun", "Toy"),
ReactionTime = key_resp.rt,
LogRT = log(key_resp.rt),
Correct = ifelse(StimObj == "Gun" & key_resp.keys == "p" | StimObj == "Toy" & key_resp.keys == "q" , 1, 0)) %>%
select(-c(participant, face, object, key_resp.rt))
acc_dat <- processed_dat %>%
group_by(ID, StimRace, StimObj) %>%
summarise(mean_accuracy = mean(Correct)) %>%
filter(mean_accuracy > 0.499)
# Turning into factors for ANOVA
processed_dat$ID <-  as_factor(processed_dat$ID)
processed_dat$StimRace <-  as_factor(processed_dat$StimRace)
processed_dat$StimObj <-  as_factor(processed_dat$StimObj)
sum_dat <- processed_dat %>%
group_by(StimRace, StimObj, ID) %>%
get_summary_stats(LogRT, type = "mean_sd")
# Boxplot for visualization
bxp <- processed_dat %>%
ggboxplot( x = "StimObj", y = "ReactionTime",
color = "StimRace", palette = "jco"
)
bxp
# running 2x2 repeated measures ANOVA
aov_model <- aov( data = processed_dat,
LogRT ~ StimObj*StimRace + Error(ID/(StimObj*StimRace)))
summary(aov_model)
### ALTERNATIVE
# Perform the repeated measures ANOVA
anova_result <- ezANOVA(data = processed_dat,
dv = .(LogRT),
wid = .(ID),
within = .(StimRace, StimObj),
detailed = TRUE)
print(anova_result)
# Consider this model
lmer( data = processed_dat,
LogRT ~ StimObj*StimRace + (1|ID))
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime), stat = "identity", fill=StimRace)
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime), stat = "identity", fill="StimRace")
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime), stat = "identity", fill="StimRace") +
barplot
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime), stat = "identity", fill="StimRace")
barplot
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime, color=StimRace), stat = "identity")
barplot
barplot <- processed_dat %>%
ggplot() +
geom_bar(aes(x=StimObj, y=ReactionTime, color=StimRace), stat = "identity") +
position_dodge()
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, color=StimRace)) +
geom_bar(stat = "identity", position=position_dodge())
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge())
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_minimal()
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_classic()
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_classic2()
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_grey()
barplot
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_grey()
barplot + scale_fill_brewer(palette="Blues")
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
theme_classic()
barplot + scale_fill_brewer(palette="Blues")
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge())
barplot + scale_fill_brewer(palette="Blues")
barplot <- processed_dat %>%
ggplot(aes(x=StimObj, y=ReactionTime, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge())
barplot + scale_fill_brewer(palette="Paired")
se = sd(processed_dat$ReactionTime) / sqrt(length(processed_dat$ReactionTime))
sum_dat_plot <- processed_dat %>%
group_by(StimObj, StimRace) %>%
summarise(
n=n(),
mean=mean(ReactionTime),
sd=sd(ReactionTime)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ic=se * qt((1-0.05)/2 + .5, n-1))
barplot <- sum_dat_plott %>%
ggplot(aes(x=StimObj, y=mean, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_errorbar(aes(ymin=mean-ci, ymax=mean+ci), width=.2,
position=position_dodge(.9))
barplot <- sum_dat_plot %>%
ggplot(aes(x=StimObj, y=mean, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_errorbar(aes(ymin=mean-ci, ymax=mean+ci), width=.2,
position=position_dodge(.9))
barplot + scale_fill_brewer(palette="Paired")
sum_dat_plot <- processed_dat %>%
group_by(StimObj, StimRace) %>%
summarise(
n=n(),
mean=mean(ReactionTime),
sd=sd(ReactionTime)
) %>%
mutate( se=sd/sqrt(n))  %>%
mutate( ci=se * qt((1-0.05)/2 + .5, n-1))
barplot <- sum_dat_plot %>%
ggplot(aes(x=StimObj, y=mean, fill=StimRace)) +
geom_bar(stat = "identity", position=position_dodge()) +
geom_errorbar(aes(ymin=mean-ci, ymax=mean+ci), width=.2,
position=position_dodge(.9))
barplot + scale_fill_brewer(palette="Paired")
# running 2x2 repeated measures ANOVA
aov_model <- aov( data = processed_dat,
LogRT ~ StimObj*StimRace + Error(ID/(StimObj*StimRace)))
summary(aov_model)
### ALTERNATIVE
# Perform the repeated measures ANOVA
anova_result <- ezANOVA(data = processed_dat,
dv = .(LogRT),
wid = .(ID),
within = .(StimRace, StimObj),
detailed = TRUE)
print(anova_result)
# running 2x2 repeated measures ANOVA
aov_model <- aov( data = processed_dat,
LogRT ~ StimObj*StimRace + Error(ID/(StimObj*StimRace)))
summary(aov_model)
### ALTERNATIVE
# Perform the repeated measures ANOVA
anova_result <- ezANOVA(data = processed_dat,
dv = .(LogRT),
wid = .(ID),
within = .(StimRace, StimObj),
detailed = TRUE)
print(anova_result)
# Boxplot for visualization
bxp <- processed_dat %>%
ggboxplot( x = "StimObj", y = "ReactionTime",
color = "StimRace", palette = "jco"
)
bxp
